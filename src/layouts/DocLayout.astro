---
import type { MarkdownHeading } from 'astro';
import type { CollectionEntry } from 'astro:content';
import LeftSidebar from '../components/LeftSidebar/LeftSidebar.astro';
import RightSidebar from '../components/RightSidebar/RightSidebar.astro';
import HeadSEO from '../components/HeadSEO.astro';
import PageLayout from '../layouts/PageLayout.astro';
import { GITHUB_EDIT_URL } from '../consts';

type Props = CollectionEntry<'docs'>['data'] & {
	headings: MarkdownHeading[];
};

const { headings, title, tags, ...data } = Astro.props;
const canonicalURL = new URL(Astro.url.pathname, Astro.site);
const currentPage = Astro.url.pathname;
const currentFile = `src/content/${currentPage.replace(/\/$/, '')}.md`;
const githubEditUrl = `${GITHUB_EDIT_URL}/${currentFile}`;
---
<HeadSEO {...data} canonicalUrl={canonicalURL} slot="extra_head" />

<PageLayout headings={headings} {...data}>
<div class="column" slot="in_body_top">
	<LeftSidebar currentPage={currentPage} />
</div>

<div class="column content is-half">
	<h1 class="title">{title}</h1>
	<hr>
	<slot />
</div>

<div class="column" slot="in_body_end">
	<RightSidebar headings={headings} githubEditUrl={githubEditUrl} tags={tags} />
</div>

</PageLayout>
